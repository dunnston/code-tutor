[
  {
    "concept_id": "function-basics",
    "language_id": "gdscript",
    "explanation": "Functions in GDScript are defined with the 'func' keyword. They organize code into reusable blocks. Common in Godot: _ready() runs when node enters tree, _process(delta) runs every frame, _physics_process(delta) for physics updates.",
    "code_example": "# Basic function definition\nfunc greet_player():\n    print(\"Welcome, Hero!\")\n    print(\"Your adventure begins!\")\n\n# Calling the function\nfunc _ready():\n    greet_player()  # Call when scene loads\n    greet_player()  # Can call multiple times\n\n# Function with multiple statements\nfunc show_player_stats():\n    print(\"=== Player Stats ===\")\n    print(\"Health: \", health)\n    print(\"Mana: \", mana)\n    print(\"Level: \", level)\n    print(\"===================\")\n\n# Godot lifecycle functions\nfunc _ready():\n    # Called when node enters scene tree\n    print(\"Node is ready!\")\n    initialize_player()\n\nfunc _process(delta: float):\n    # Called every frame\n    # delta is time since last frame\n    update_animation()\n    check_input()\n\nfunc _physics_process(delta: float):\n    # Called every physics frame (fixed timestep)\n    # Use for physics and movement\n    velocity.y += GRAVITY * delta\n    move_and_slide()\n\n# Functions calling other functions\nfunc start_game():\n    setup_level()\n    spawn_player()\n    play_music()\n    print(\"Game started!\")\n\nfunc setup_level():\n    print(\"Setting up level...\")\n\nfunc spawn_player():\n    print(\"Spawning player...\")\n\nfunc play_music():\n    print(\"Playing music...\")\n\n# Signal handler functions (connected to signals)\nfunc _on_button_pressed():\n    print(\"Button was pressed!\")\n    start_game()\n\nfunc _on_enemy_died():\n    score += 100\n    check_victory_condition()\n\n# Functions for organization\nfunc handle_player_movement():\n    if Input.is_action_pressed(\"ui_right\"):\n        velocity.x = SPEED\n    elif Input.is_action_pressed(\"ui_left\"):\n        velocity.x = -SPEED\n    else:\n        velocity.x = 0\n\nfunc handle_player_jump():\n    if Input.is_action_just_pressed(\"jump\") and is_on_floor():\n        velocity.y = JUMP_VELOCITY",
    "syntax_notes": "Use 'func' keyword. Function names use snake_case. Called with parentheses: function_name(). Godot built-in functions start with underscore (_ready, _process, etc.). No 'def' keyword like Python.",
    "common_mistakes": "[\"Forgetting parentheses when calling\", \"Using 'def' instead of 'func'\", \"Calling a function before it's defined\", \"Forgetting colon after func name\", \"Not understanding _ready vs _process\"]"
  },
  {
    "concept_id": "parameters-arguments",
    "language_id": "gdscript",
    "explanation": "Parameters allow functions to accept input. Can include type hints for better error checking and performance. GDScript supports positional and keyword arguments.",
    "code_example": "# Function with one parameter\nfunc greet(player_name):\n    print(\"Hello, \", player_name, \"!\")\n\ngreet(\"Hero\")  # \"Hero\" is the argument\ngreet(\"Warrior\")  # \"Warrior\" is the argument\n\n# Multiple parameters\nfunc deal_damage(target, amount):\n    target.health -= amount\n    print(\"Dealt \", amount, \" damage to \", target.name)\n\nvar enemy = get_node(\"Enemy\")\ndeal_damage(enemy, 50)\n\n# Type-hinted parameters (recommended)\nfunc calculate_damage(attack: int, defense: int) -> int:\n    var damage = attack - defense\n    return max(0, damage)\n\nvar result = calculate_damage(50, 10)  # 40\n\n# Parameters with different types\nfunc create_enemy(enemy_name: String, health: int, position: Vector2):\n    print(\"Creating enemy: \", enemy_name)\n    var enemy = enemy_scene.instantiate()\n    enemy.name = enemy_name\n    enemy.health = health\n    enemy.global_position = position\n    add_child(enemy)\n\ncreate_enemy(\"Goblin\", 50, Vector2(100, 200))\n\n# Using parameters in calculations\nfunc move_towards(target_pos: Vector2, speed: float, delta: float):\n    var direction = (target_pos - global_position).normalized()\n    global_position += direction * speed * delta\n\n# Node parameters\nfunc apply_damage_to_area(center: Vector2, radius: float, damage: int):\n    var enemies = get_tree().get_nodes_in_group(\"enemies\")\n    for enemy in enemies:\n        var distance = enemy.global_position.distance_to(center)\n        if distance <= radius:\n            enemy.take_damage(damage)\n\n# Keyword arguments (calling with names)\nfunc spawn_projectile(position: Vector2, direction: Vector2, speed: float, damage: int):\n    # ... implementation ...\n    pass\n\n# Can call with keyword arguments in any order\nspawn_projectile(\n    damage = 25,\n    speed = 300.0,\n    direction = Vector2.RIGHT,\n    position = global_position\n)\n\n# Signal with parameters\nfunc _on_area_entered(area: Area2D):\n    if area.is_in_group(\"collectibles\"):\n        collect_item(area)\n        area.queue_free()",
    "syntax_notes": "Parameters defined in function signature. Type hints use colon (name: Type). Separate multiple parameters with commas. Can call with keyword arguments using name=value.",
    "common_mistakes": "[\"Wrong argument order\", \"Wrong number of arguments\", \"Not using type hints (misses errors and performance)\", \"Confusing parameter names with outside variables\"]"
  },
  {
    "concept_id": "return-values",
    "language_id": "gdscript",
    "explanation": "Functions can return values using the 'return' keyword. Use return type hints (-> Type) to specify what the function returns. Once return executes, the function exits immediately.",
    "code_example": "# Function that returns a value\nfunc calculate_damage(attack: int, defense: int) -> int:\n    var damage = attack - defense\n    return max(0, damage)\n\nvar total_damage = calculate_damage(50, 10)\nprint(\"Damage: \", total_damage)  # 40\n\n# Using return value directly\nprint(\"Damage: \", calculate_damage(30, 5))  # 25\n\n# Return type hints\nfunc get_player_health() -> int:\n    return health\n\nfunc get_player_position() -> Vector2:\n    return global_position\n\nfunc is_player_alive() -> bool:\n    return health > 0\n\nfunc get_player_name() -> String:\n    return player_name\n\n# Multiple returns (only one executes)\nfunc get_rank(score: int) -> String:\n    if score >= 90:\n        return \"Gold\"\n    elif score >= 70:\n        return \"Silver\"\n    else:\n        return \"Bronze\"\n\nvar rank = get_rank(85)\nprint(\"Your rank: \", rank)  # \"Silver\"\n\n# Early return pattern\nfunc try_open_door() -> bool:\n    if not has_key:\n        print(\"You need a key!\")\n        return false  # Exit early\n    \n    if door_broken:\n        print(\"The door is broken!\")\n        return false  # Exit early\n    \n    # Only reaches here if all checks pass\n    door_open = true\n    print(\"Door opened!\")\n    return true\n\n# Returning nodes\nfunc find_nearest_enemy() -> Node2D:\n    var enemies = get_tree().get_nodes_in_group(\"enemies\")\n    var nearest = null\n    var min_distance = INF\n    \n    for enemy in enemies:\n        var distance = global_position.distance_to(enemy.global_position)\n        if distance < min_distance:\n            min_distance = distance\n            nearest = enemy\n    \n    return nearest\n\n# Returning null\nfunc find_item(item_name: String) -> Node:\n    for child in get_children():\n        if child.name == item_name:\n            return child\n    return null  # Not found\n\n# Using returned values in expressions\nfunc double_value(n: int) -> int:\n    return n * 2\n\nvar result = double_value(5) + double_value(3)  # 10 + 6 = 16\n\n# Functions without explicit return (return null)\nfunc play_sound():\n    $AudioPlayer.play()\n    # No return statement = returns null\n\nvar value = play_sound()  # value is null\n\n# Returning multiple values (using Dictionary or Array)\nfunc get_player_stats() -> Dictionary:\n    return {\n        \"health\": health,\n        \"mana\": mana,\n        \"level\": level\n    }\n\nvar stats = get_player_stats()\nprint(\"Health: \", stats[\"health\"])\n\n# Or using Array\nfunc get_position_and_velocity() -> Array:\n    return [global_position, velocity]\n\nvar data = get_position_and_velocity()\nvar pos = data[0]\nvar vel = data[1]",
    "syntax_notes": "Use 'return' to send value back. Specify return type with -> Type. Functions without return automatically return null. Code after return won't execute. Can return any type: int, float, String, bool, Node, Vector2, etc.",
    "common_mistakes": "[\"Forgetting to capture return value\", \"Using print instead of return\", \"Code after return (never runs)\", \"Not specifying return type hint\", \"Returning wrong type\"]"
  },
  {
    "concept_id": "scope",
    "language_id": "gdscript",
    "explanation": "Variable scope determines where variables can be accessed. Local variables exist only inside their function. Member variables (defined at class level) are accessible throughout the class. Use @onready for node references.",
    "code_example": "extends CharacterBody2D\n\n# Member variables (accessible in all functions)\nvar health = 100  # Class scope\nvar mana = 50\nvar level = 1\n\n# Constants (also class scope)\nconst MAX_HEALTH = 100\nconst SPEED = 200.0\n\n# Node references (initialized when node enters tree)\n@onready var sprite = $Sprite2D\n@onready var animation_player = $AnimationPlayer\n\nfunc _ready():\n    # Can access member variables\n    print(\"Health: \", health)\n    print(\"Max health: \", MAX_HEALTH)\n    \n    # Local variable\n    var greeting = \"Hello!\"  # Only exists in _ready()\n    print(greeting)\n\n# Can't access 'greeting' here - it's local to _ready()\n\nfunc take_damage(amount: int):\n    # Local variable\n    var damage_taken = amount\n    \n    # Modify member variable\n    health -= damage_taken\n    \n    print(\"Took \", damage_taken, \" damage\")\n    print(\"Health now: \", health)\n\n# Can't access 'damage_taken' here\n\nfunc heal(amount: int):\n    # Local variable\n    var heal_amount = amount\n    \n    # Access member variable\n    health += heal_amount\n    if health > MAX_HEALTH:\n        health = MAX_HEALTH\n    \n    print(\"Healed \", heal_amount, \" HP\")\n\n# Shadowing - local variable hides member variable\nvar score = 100  # Member variable\n\nfunc calculate_bonus():\n    var score = 50  # Local variable (shadows member variable)\n    print(score)  # Prints 50 (local), not 100 (member)\n    \n    # To access member variable when shadowed, no way in GDScript!\n    # Better: use different names\n\n# Better approach - different names\nfunc calculate_bonus_better():\n    var bonus_score = 50  # Local\n    var total = score + bonus_score  # Uses member variable 'score'\n    return total\n\n# Parameters are local variables\nfunc greet(player_name: String):  # player_name is local\n    var message = \"Hello, \" + player_name  # message is also local\n    print(message)\n\n# Can't access player_name or message here\n\n# Accessing parent scope (signals and nested functions)\nfunc outer_function():\n    var outer_value = 10\n    \n    # Inner function (lambda/callable)\n    var my_callable = func():\n        print(outer_value)  # Can access outer scope\n    \n    my_callable.call()  # Prints 10\n\n# Static variables (shared across all instances)\nstatic var total_enemies_spawned = 0\n\nfunc _ready():\n    total_enemies_spawned += 1\n    print(\"Total enemies: \", total_enemies_spawned)\n\n# Accessing nodes affects scope\n@onready var health_label = $UI/HealthLabel\n\nfunc update_health_display():\n    # Can access health_label because it's a member variable\n    health_label.text = \"HP: %d\" % health\n\n# Global variables (using autoload singletons)\n# In Global.gd (autoload):\n# var player_name = \"Hero\"\n# var game_score = 0\n\n# In any script:\nfunc use_global():\n    print(Global.player_name)  # Access global\n    Global.game_score += 10  # Modify global",
    "syntax_notes": "Member variables defined at class level. Local variables defined in functions. Use @onready for node references. Parameters are local. No 'self' keyword needed. Static variables shared across instances.",
    "common_mistakes": "[\"Assuming local variables work outside their function\", \"Shadowing member variables unintentionally\", \"Forgetting @onready for node references\", \"Overusing global variables\"]"
  },
  {
    "concept_id": "default-parameters",
    "language_id": "gdscript",
    "explanation": "Default parameters let you specify default values. If an argument isn't provided, the default is used. Makes functions more flexible. Default parameters must come after required ones.",
    "code_example": "# Function with default parameter\nfunc greet(player_name: String = \"Adventurer\"):\n    print(\"Hello, \", player_name, \"!\")\n\ngreet(\"Hero\")  # \"Hello, Hero!\"\ngreet()  # \"Hello, Adventurer!\" (uses default)\n\n# Multiple default parameters\nfunc create_enemy(enemy_name: String, health: int = 100, level: int = 1):\n    print(\"Enemy: \", enemy_name)\n    print(\"Health: \", health)\n    print(\"Level: \", level)\n\ncreate_enemy(\"Goblin\")  # Uses default health and level\ncreate_enemy(\"Orc\", 150)  # Custom health, default level\ncreate_enemy(\"Dragon\", 500, 10)  # Custom all values\n\n# Default parameters with type hints\nfunc spawn_projectile(\n    position: Vector2,\n    direction: Vector2 = Vector2.RIGHT,\n    speed: float = 300.0,\n    damage: int = 10\n):\n    var projectile = projectile_scene.instantiate()\n    projectile.global_position = position\n    projectile.velocity = direction.normalized() * speed\n    projectile.damage = damage\n    add_child(projectile)\n\n# Call with various combinations\nspawn_projectile(global_position)  # All defaults\nspawn_projectile(global_position, Vector2.UP)  # Custom direction\nspawn_projectile(global_position, Vector2.UP, 500.0)  # Custom direction and speed\n\n# Keyword arguments with defaults\nspawn_projectile(\n    position = global_position,\n    damage = 25  # Skip direction and speed, use defaults\n)\n\n# Default parameter as Vector2\nfunc move_to(target: Vector2 = Vector2.ZERO):\n    global_position = target\n\nmove_to()  # Moves to (0, 0)\nmove_to(Vector2(100, 200))  # Moves to (100, 200)\n\n# Default bool parameter\nfunc play_sound(sound_name: String, looping: bool = false, volume: float = 0.0):\n    var player = AudioStreamPlayer.new()\n    player.stream = load(\"res://sounds/\" + sound_name + \".ogg\")\n    player.volume_db = volume\n    if looping:\n        # Set loop property\n        pass\n    add_child(player)\n    player.play()\n\nplay_sound(\"sword_swing\")  # Default: not looping, 0 dB\nplay_sound(\"background_music\", true, -10.0)  # Looping, quieter\n\n# Default parameter from constant\nconst DEFAULT_SPEED = 200.0\n\nfunc set_speed(speed: float = DEFAULT_SPEED):\n    velocity.x = speed\n\n# Default null parameter\nfunc attack_target(target: Node2D = null):\n    if target == null:\n        # Find nearest enemy\n        target = find_nearest_enemy()\n    \n    if target != null:\n        deal_damage(target, 10)\n\nattack_target()  # Attacks nearest enemy\nattack_target(specific_enemy)  # Attacks specific enemy\n\n# Complex default (Dictionary)\nfunc create_character(stats: Dictionary = {\"health\": 100, \"mana\": 50, \"level\": 1}):\n    print(\"Creating character with stats: \", stats)\n\ncreate_character()  # Uses default stats\ncreate_character({\"health\": 150, \"mana\": 75, \"level\": 5})  # Custom stats\n\n# Practical: configurable damage function\nfunc deal_damage(\n    target: Node2D,\n    base_damage: int,\n    critical: bool = false,\n    elemental_multiplier: float = 1.0,\n    show_numbers: bool = true\n):\n    var final_damage = base_damage\n    \n    if critical:\n        final_damage *= 2\n    \n    final_damage = int(final_damage * elemental_multiplier)\n    \n    target.health -= final_damage\n    \n    if show_numbers:\n        show_damage_number(final_damage)\n    \n    return final_damage",
    "syntax_notes": "Default parameters use = in function signature. Must come after required parameters. Can use keyword arguments to skip some defaults. Don't use mutable defaults (like []) - use null and create inside function.",
    "common_mistakes": "[\"Putting defaults before required parameters\", \"Using mutable defaults (like []or {})\", \"Not understanding keyword argument order flexibility\", \"Too many default parameters (makes API confusing)\"]"
  }
]
